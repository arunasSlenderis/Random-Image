!function(e){function t(i){if(s[i])return s[i].exports;var r=s[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var s={};return t.m=e,t.c=s,t.p="/",t(0)}([function(e,t,s){e.exports=s(3)},function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s(8),n=i(r),a=s(2),d=i(a),u=process.env.NODE_ENV||"development",o=void 0;o="production"===u?new n["default"](process.env.DATABASE_URL,{dialect:"postgres"}):new n["default"]("random_images","root","");var l={};l.like=o["import"](d["default"].resolve("./server/database/models/like.js")),l.usersIP=o["import"](d["default"].resolve("./server/database/models/usersIp.js")),l.Sequelize=n["default"],l.connection=o,t["default"]=l},function(e,t){e.exports=require("path")},function(e,t,s){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}s(9);var n=s(7),a=r(n),d=s(5),u=r(d),o=s(1),l=r(o),f=s(4),c=i(f),p=(0,a["default"])(),v=process.env.PORT||3e3;p.use(a["default"]["static"]("./dist")),p.use(u["default"].urlencoded({extended:!0})),p.use(u["default"].json()),p.get("/",c.home),p.post("/info",c.info),l["default"].connection.sync({}).then(function(){p.listen(v,function(e){if(e)throw new Error("Server fault: ",e);console.log("Server is listening on port:",v)})})},function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.home=void 0;var r=s(2),n=i(r),a=s(6),d=i(a),u=s(1),o=i(u);t.home=function(e,t){t.sendFile(n["default"].resolve("./src/index.html"))},t.info=function(e,t){var s=e.body.imageId,i=e.body.ip,r=e.body.likePressed,n=e.body.dislikePressed;o["default"].like.findOne({where:{imageId:s}}).then(function(e){var a={likes:e?e.dataValues.likes:"0",dislikes:e?e.dataValues.dislikes:"0",views:e?e.dataValues.views:"1"};e?o["default"].usersIP.findAll({where:{imageId:s}}).then(function(s){var d=s.find(function(e){return i===e.dataValues.ip});d.dataValues.liked_disliked===!1?(r||n)&&(d.update({liked_disliked:!0}),e.update({likes:r?e.dataValues.likes+1:e.dataValues.likes,dislikes:n?e.dataValues.dislikes+1:e.dataValues.dislikes}).then(function(e){a.likes=e.dataValues.likes,a.dislikes=e.dataValues.dislikes,t.send(a)})):d||e.update({views:e.dataValues.views+1}).then(function(e){a.views=e.dataValues.views,t.send(a)})}):(o["default"].like.create({imageId:s,likes:0,dislikes:0,views:1}),o["default"].usersIP.create({imageId:s,ip:i,liked_disliked:!1}),t.send(a))})["catch"](function(e){console.log(d["default"].red("Error finding image: ",e))})}},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("chalk")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("source-map-support/register")}]);
//# sourceMappingURL=server.js.map